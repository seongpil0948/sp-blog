# Intro
- 서비스 생성
- 구성 및 문제 해결 시스템 성능 및 서비스 모니터링 및 문제 해결 
- 애플리케이션 및 서비스별 제약 조건 결정 
- 디스크 공간 문제 해결 
- SSL 인증서 작업

### Read & use system documentation
먼저 명령어의 메뉴얼을 어떻게 사용할지 메뉴얼을 보면 좋다.
```sh
man man

# printf 함수의 메뉴얼을 보고 싶다면
man 3 printf

# 관리자 권한으로 실행 가능한 커맨드를 보고싶다면
# System administration commands (usually only for root)
man 8 clear
```

만약 메뉴얼을 보고 싶은 명령어가 기억나지 않는다면? `apropos` 명령어를 사용하면 된다.
디렉토리 관련 명령어를 찾고 싶다면 다음과 같이 사용하면 된다.
```sh
apropos -s 1,8 director
```
위 명령어는 검색어 기준으로 description을 검색한다.
만약 DB 가 초기화 되지 않아 검색이 되지 않는다면 다음과 같이 사용하면 된다.
```sh
sudo mandb
``` 

## Manage Hard & Soft Links
`stat` 명령어를 사용하면 파일의 정보를 확인할 수 있다.
```sh
# stat -x /etc/passwd
File: "/etc/passwd"
Size: 8460         FileType: Regular File
Mode: (0644/-rw-r--r--)         Uid: (    0/    root)  Gid: (    0/   wheel)
Device: 1,14   Inode: 29124160    Links: 1
Access: Fri Dec 15 23:43:29 2023
Modify: Fri Dec 15 23:43:29 2023
Change: Wed Dec 20 16:47:12 2023
Birth: Fri Dec 15 23:43:29 2023

# stat -x ~/Code/Temp/demo/mvnw
File: "/Users/choeseongpil/Code/Temp/demo/mvnw"
Size: 11290        FileType: Regular File
Mode: (0755/-rwxr-xr-x)         Uid: (  501/choeseongpil)  Gid: (   20/   staff)
Device: 1,14   Inode: 27147791    Links: 1
Access: Fri Dec  8 15:50:29 2023
Modify: Fri Dec  8 15:50:29 2023
Change: Fri Dec  8 15:50:29 2023
 Birth: Fri Dec  8 15:50:29 2023
```
위에서 우리는 iNode 와 Links 를 확인할 수 있다.
ZFS, x-t4 등과 같은 파일 시스템은 AI 노드의 도움으로 데이터를 추적합니다.
우리 사진에는 디스크 전체에 흩어져 있는 데이터 블록이 있을 수 있지만, inode는 모든 것을 기억합니다
우리는 파일 시스템에게 inode를 사용하여 파일을 찾도록 요청합니다.

### Hard Link
이전 출력에서 나타난 `Links: 1` 은 파일에 대한 하드 링크의 수를 나타냅니다.
ln 명령어를 사용하여 하드 링크를 만들 수 있고 링크들이 생성된 만큼 Links 의 수가 증가합니다.
하드링크의 수가 0이되면 파일이 삭제됩니다.
```
echo "initialized $PWD" > a.yaml

ln a.yaml b.yaml

cat a.yaml
initialized /Users/choeseongpil/Code/Temp
cat b.yaml
initialized /Users/choeseongpil/Code/Temp

vi a.yaml

cat b.yaml
initialized /Users/choeseongpil/Code/Temp
zz

stat -x a.yaml
File: "a.yaml"
Size: 45           FileType: Regular File
Mode: (0644/-rw-r--r--)         Uid: (  501/choeseongpil)  Gid: (   20/   staff)
Device: 1,14   Inode: 31545064    Links: 2
Access: Sun Jan 14 18:13:45 2024
Modify: Sun Jan 14 18:13:43 2024
Change: Sun Jan 14 18:13:43 2024
Birth: Sun Jan 14 18:13:12 2024

stat -x b.yaml
File: "b.yaml"
Size: 45           FileType: Regular File
Mode: (0644/-rw-r--r--)         Uid: (  501/choeseongpil)  Gid: (   20/   staff)
Device: 1,14   Inode: 31545064    Links: 2
Access: Sun Jan 14 18:13:45 2024
Modify: Sun Jan 14 18:13:43 2024
Change: Sun Jan 14 18:13:43 2024
Birth: Sun Jan 14 18:13:12 2024
```
보면 두 파일의 inode 가 같은 것을 확인할 수 있다.

#### Limitation
- 파일에만 하드 링크할 수 있고 디렉터리에는 하드 링크할 수 없습니다. 
- 동일한 파일 시스템에 있는 파일에만 하드 링크할 수도 있습니다. 예를 들어, `/backup`에 외부 드라이브를 마운트한 경우 다음을 수행할 수 없습니다. 
- 파일 권한에 대한 에러가 발생할 수 있습니다. 사용자들을 특정 그룹으로 묶어 파일에 해당 그룹을 할당하여 에러를 최소화합니다.


### Soft Link
소프트 링크는 하드 링크와 다르게 파일의 내용(inode)을 복사하지 않고 파일의 경로만을 복사합니다.
```sh
ln -s a.yaml c.yaml
ls -l
```
l자로 시작하는 부분은 symbolic link 를 의미합니다.
마지막 컬럼은 어떤 파일을 가리키는지도 나타냅니다.
```
total 4
-rw-rw-r-- 1 abacus abacus 30 Jan 14 15:20 a.yaml
lrwxrwxrwx 1 abacus abacus  6 Jan 14 15:20 b.yaml -> a.yaml
lrwxrwxrwx 1 abacus abacus  6 Jan 14 15:21 c.yaml -> a.yaml
```
링크만을 알고싶다면
```sh
ls -l | grep "^l"
readlink c.yaml
```



### bash: ldd로 의존성 탐색
어떤 프로그램은 프로그램 파일만으로 실행이 되기도 하지만, 많은 프로그램들은 시스템 상에 다른 파일에 의존하고 있습니다. 이를 동적 라이브러리라고 합니다. bash 또한 이러한 파일들에 대한 의존성을 가지고 있고, 파일 시스템 아래에 이 파일들이 존재하지 않으면 실행이 되지 않습니다. 어떤 프로그램이 의존하고 있는 라이브러리 파일을 추적할 수 있는 프로그램이 바로 ldd입니다. ldd는 다음과 같이 사용합니다.
```
$ ldd /bin/bash
        linux-vdso.so.1 (0x00007ffe988fb000)
        libtinfo.so.5 => /lib/x86_64-linux-gnu/libtinfo.so.5 (0x00007f1a60cd2000)
        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f1a60ace000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f1a606dd000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f1a61216000)
```